export function toNum(v){const n=parseFloat(v);return Number.isFinite(n)?n:0;} export function fmtNumber(v,d=1){return Number.isFinite(v)?v.toFixed(d):'0.0';} export function fmtPct(m,a){m=toNum(m);a=toNum(a);if(!a)return 'â€”';return (100*m/a).toFixed(1);} export function parseCsv(t){const l=t.trim().split(/\r?\n/);if(!l.length)return[];const h=l[0].split(',').map(s=>s.trim());const rows=[];for(let i=1;i<l.length;i++){if(!l[i].trim())continue;const c=l[i].split(',').map(s=>s.trim());const r={};h.forEach((hh,idx)=>r[hh]=c[idx]??'');rows.push(r);}return rows;} export function getYearAndSeasonLabel(dateStr){if(!dateStr)return{year:null,seasonLabel:null};let d;if(/^\d{4}-\d{2}-\d{2}$/.test(dateStr)){d=new Date(dateStr+'T00:00:00');}else if(/^\d{1,2}\/\d{1,2}\/\d{4}$/.test(dateStr)){const [dd,mm,yy]=dateStr.split('/').map(Number);d=new Date(yy,mm-1,dd);}else{d=new Date(dateStr);}if(Number.isNaN(d.getTime()))return{year:null,seasonLabel:null};const y=d.getFullYear();const m=d.getMonth()+1;let s='Summer';if(m>=3&&m<=5)s='Autumn';else if(m>=6&&m<=8)s='Winter';else if(m>=9&&m<=11)s='Spring';return{year:y,seasonLabel:`${y} ${s}`};}